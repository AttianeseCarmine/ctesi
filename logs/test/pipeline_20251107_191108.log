=========================================
PIPELINE AVVIATA: Fri Nov  7 07:11:08 PM CET 2025
CONFIG: configs/sha.yaml
OUTPUT: output/sha_staged_training_v1
LOG: logs/test/pipeline_20251107_191108.log
=========================================
 
=========================================
ðŸš€ AVVIO STADIO 1: Pre-training PI Head (ZIP)
=========================================
/user/cattianese/miniconda3/envs/ctesi/lib/python3.12/site-packages/open_clip/factory.py:450: UserWarning: QuickGELU mismatch between final model config (quick_gelu=False) and pretrained tag 'openai' (quick_gelu=True).
  warnings.warn(
ðŸš€ AVVIO DELLO STADIO 1 ðŸš€
Costruzione modello: _clip_ebc
Traceback (most recent call last):
  File "/user/cattianese/ctesi/train.py", line 182, in <module>
    main(args, cfg)
  File "/user/cattianese/ctesi/train.py", line 42, in main
    model = build_model(cfg).to(device)
            ^^^^^^^^^^^^^^^^
  File "/user/cattianese/ctesi/models/__init__.py", line 29, in build_model
    model = _clip_ebc(**build_params)
            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/user/cattianese/ctesi/models/clip_ebc/model.py", line 283, in _clip_ebc
    return CLIP_EBC(
           ^^^^^^^^^
  File "/user/cattianese/ctesi/models/clip_ebc/model.py", line 141, in __init__
    self._build_text_feats()
  File "/user/cattianese/ctesi/models/clip_ebc/model.py", line 177, in _build_text_feats
    pi_text_feats = encode_text(model_name, weight_name, pi_text_prompts)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/user/cattianese/ctesi/models/clip_ebc/utils.py", line 102, in encode_text
    text = open_clip.get_tokenizer(model_name)(text).to(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/user/cattianese/miniconda3/envs/ctesi/lib/python3.12/site-packages/open_clip/tokenizer.py", line 256, in __call__
    all_tokens = [[self.sot_token_id] + self.encode(text) + [self.eot_token_id] for text in texts]
                                        ^^^^^^^^^^^^^^^^^
  File "/user/cattianese/miniconda3/envs/ctesi/lib/python3.12/site-packages/open_clip/tokenizer.py", line 215, in encode
    text = self.clean_fn(text)
           ^^^^^^^^^^^^^^^^^^^
  File "/user/cattianese/miniconda3/envs/ctesi/lib/python3.12/site-packages/open_clip/tokenizer.py", line 85, in _clean_lower
    return whitespace_clean(basic_clean(x)).lower()
                            ^^^^^^^^^^^^^^
  File "/user/cattianese/miniconda3/envs/ctesi/lib/python3.12/site-packages/open_clip/tokenizer.py", line 67, in basic_clean
    text = ftfy.fix_text(text)
           ^^^^^^^^^^^^^^^^^^^
  File "/user/cattianese/miniconda3/envs/ctesi/lib/python3.12/site-packages/ftfy/__init__.py", line 349, in fix_text
    textbreak = text.find("\n", pos) + 1
                ^^^^^^^^^
AttributeError: 'list' object has no attribute 'find'
